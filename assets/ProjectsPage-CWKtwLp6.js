import{z as K,K as Ze,L as Je,D as v,M as pe,N as ge,C as Z,p as B,T as ze,O as Le,P as et,E as J,R as Ie,r as z,S as tt,U as W,v as le,Q as ve,m as I,V as Ne,W as De,X as Te,Y as Be,Z as ot,_ as lt,G as at,H as nt,a as he,$ as fe,j as U,o as O,w as S,e as d,h as p,y as ye,t as be,x as E,a0 as $e,a1 as it,F as se,k as oe,n as H,c as ee,a2 as rt,a3 as st,a4 as ut}from"./index--h6_vfO-.js";import{u as dt,b as ct,a as ft,Q as A}from"./QInput-CsRd1fYR.js";import{u as we,Q as Ee}from"./use-quasar-X6Lp6m-T.js";import{u as Oe,g as mt,h as pt,b as te,i as gt,j as vt,k as ht,d as Se,e as He,C as _e,l as yt,f as Ve,Q as bt,a as ue,c as wt}from"./ClosePopup-Ci_hn4yl.js";import{Q as X}from"./QCard-DMtk_vtU.js";import{Q as Y}from"./uid-BrPC7ZYM.js";import{Q as St}from"./QPage-DHSi9zRF.js";import{Q as me}from"./QSeparator-M0rqPBTW.js";import{Q as _t}from"./QBanner-DJkCgzjS.js";const Ct='<circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="60" cy="15" r="9" fill-opacity=".3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from=".5" to=".5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle>',Ce=K({name:"QSpinnerDots",props:Ze,setup(e){const{cSize:t,classes:o}=Je(e);return()=>v("svg",{class:o.value,fill:"currentColor",width:t.value,height:t.value,viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",innerHTML:Ct})}}),ke=K({name:"QInnerLoading",props:{...pe,...Oe,showing:Boolean,color:String,size:{type:[String,Number],default:"42px"},label:String,labelClass:String,labelStyle:[String,Array,Object]},setup(e,{slots:t}){const o=Z(),l=ge(e,o.proxy.$q),{transitionProps:r,transitionStyle:h}=mt(e),a=B(()=>"q-inner-loading q--avoid-card-border absolute-full column flex-center"+(l.value===!0?" q-inner-loading--dark":"")),f=B(()=>"q-inner-loading__label"+(e.labelClass!==void 0?` ${e.labelClass}`:""));function w(){const s=[v(Le,{size:e.size,color:e.color})];return e.label!==void 0&&s.push(v("div",{class:f.value,style:e.labelStyle},[e.label])),s}function k(){return e.showing===!0?v("div",{class:a.value,style:h.value},t.default!==void 0?t.default():w()):null}return()=>v(ze,r.value,k)}});function Qe(e,t){if(t&&e===t)return null;const o=e.nodeName.toLowerCase();if(["div","li","ul","ol","blockquote"].includes(o)===!0)return e;const l=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,r=l.display;return r==="block"||r==="table"?e:Qe(e.parentNode)}function de(e,t,o){return!e||e===document.body?!1:o===!0&&e===t||(t===document?document.body:t).contains(e.parentNode)}function Me(e,t,o){if(o||(o=document.createRange(),o.selectNode(e),o.setStart(e,0)),t.count===0)o.setEnd(e,t.count);else if(t.count>0)if(e.nodeType===Node.TEXT_NODE)e.textContent.length<t.count?t.count-=e.textContent.length:(o.setEnd(e,t.count),t.count=0);else for(let l=0;t.count!==0&&l<e.childNodes.length;l++)o=Me(e.childNodes[l],t,o);return o}const kt=/^https?:\/\//;class qt{constructor(t,o){this.el=t,this.eVm=o,this._range=null}get selection(){if(this.el){const t=document.getSelection();if(de(t.anchorNode,this.el,!0)&&de(t.focusNode,this.el,!0))return t}return null}get hasSelection(){return this.selection!==null?this.selection.toString().length!==0:!1}get range(){const t=this.selection;return t?.rangeCount?t.getRangeAt(0):this._range}get parent(){const t=this.range;if(t!==null){const o=t.startContainer;return o.nodeType===document.ELEMENT_NODE?o:o.parentNode}return null}get blockParent(){const t=this.parent;return t!==null?Qe(t,this.el):null}save(t=this.range){t!==null&&(this._range=t)}restore(t=this._range){const o=document.createRange(),l=document.getSelection();t!==null?(o.setStart(t.startContainer,t.startOffset),o.setEnd(t.endContainer,t.endOffset),l.removeAllRanges(),l.addRange(o)):(l.selectAllChildren(this.el),l.collapseToEnd())}savePosition(){let t=-1,o;const l=document.getSelection(),r=this.el.parentNode;if(l.focusNode&&de(l.focusNode,r))for(o=l.focusNode,t=l.focusOffset;o&&o!==r;)o!==this.el&&o.previousSibling?(o=o.previousSibling,t+=o.textContent.length):o=o.parentNode;this.savedPos=t}restorePosition(t=0){if(this.savedPos>0&&this.savedPos<t){const o=window.getSelection(),l=Me(this.el,{count:this.savedPos});l&&(l.collapse(!1),o.removeAllRanges(),o.addRange(l))}}hasParent(t,o){const l=o?this.parent:this.blockParent;return l!==null?l.nodeName.toLowerCase()===t.toLowerCase():!1}hasParents(t,o,l=this.parent){return l===null?!1:t.includes(l.nodeName.toLowerCase())===!0?!0:o===!0?this.hasParents(t,o,l.parentNode):!1}is(t,o){if(this.selection===null)return!1;switch(t){case"formatBlock":return o==="DIV"&&this.parent===this.el||this.hasParent(o,o==="PRE");case"link":return this.hasParent("A",!0);case"fontSize":return document.queryCommandValue(t)===o;case"fontName":const l=document.queryCommandValue(t);return l===`"${o}"`||l===o;case"fullscreen":return this.eVm.inFullscreen.value;case"viewsource":return this.eVm.isViewingSource.value;case void 0:return!1;default:const r=document.queryCommandState(t);return o!==void 0?r===o:r}}getParentAttribute(t){return this.parent!==null?this.parent.getAttribute(t):null}can(t){if(t==="outdent")return this.hasParents(["blockquote","li"],!0);if(t==="indent")return this.hasParents(["li"],!0);if(t==="link")return this.selection!==null||this.is("link")}apply(t,o,l=et){if(t==="formatBlock")["BLOCKQUOTE","H1","H2","H3","H4","H5","H6"].includes(o)&&this.is(t,o)&&(t="outdent",o=null),o==="PRE"&&this.is(t,"PRE")&&(o="P");else if(t==="print"){l();const r=window.open();r.document.write(`
        <!doctype html>
        <html>
          <head>
            <title>Print - ${document.title}</title>
          </head>
          <body>
            <div>${this.el.innerHTML}</div>
          </body>
        </html>
      `),r.print(),r.close();return}else if(t==="link"){const r=this.getParentAttribute("href");if(r===null){const h=this.selectWord(this.selection),a=h?h.toString():"";if(!a.length&&(!this.range||!this.range.cloneContents().querySelector("img")))return;this.eVm.editLinkUrl.value=kt.test(a)?a:"https://",document.execCommand("createLink",!1,this.eVm.editLinkUrl.value),this.save(h.getRangeAt(0))}else this.eVm.editLinkUrl.value=r,this.range.selectNodeContents(this.parent),this.save();return}else if(t==="fullscreen"){this.eVm.toggleFullscreen(),l();return}else if(t==="viewsource"){this.eVm.isViewingSource.value=this.eVm.isViewingSource.value===!1,this.eVm.setContent(this.eVm.props.modelValue),l();return}document.execCommand(t,!1,o),l()}selectWord(t){if(t===null||t.isCollapsed!==!0||t.modify===void 0)return t;const o=document.createRange();o.setStart(t.anchorNode,t.anchorOffset),o.setEnd(t.focusNode,t.focusOffset);const l=o.collapsed?["backward","forward"]:["forward","backward"];o.detach();const r=t.focusNode,h=t.focusOffset;return t.collapse(t.anchorNode,t.anchorOffset),t.modify("move",l[0],"character"),t.modify("move",l[1],"word"),t.extend(r,h),t.modify("extend",l[1],"character"),t.modify("extend",l[0],"word"),t}}const xt=K({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:t}){const o=B(()=>{const l=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(r=>e[r]===!0).map(r=>`q-btn-group--${r}`).join(" ");return`q-btn-group row no-wrap${l.length!==0?" "+l:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>v("div",{class:o.value},J(t.default))}}),jt=Object.keys(Ie);function Tt(e){return jt.reduce((t,o)=>{const l=e[o];return l!==void 0&&(t[o]=l),t},{})}const Bt=K({name:"QBtnDropdown",props:{...Ie,...Oe,modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noEscDismiss:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,noRefocus:Boolean,noFocus:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean,toggleAriaLabel:String},emits:["update:modelValue","click","beforeShow","show","beforeHide","hide"],setup(e,{slots:t,emit:o}){const{proxy:l}=Z(),r=z(e.modelValue),h=z(null),a=dt(),f=B(()=>{const m={"aria-expanded":r.value===!0?"true":"false","aria-haspopup":"true","aria-controls":a.value,"aria-label":e.toggleAriaLabel||l.$q.lang.label[r.value===!0?"collapse":"expand"](e.label)};return(e.disable===!0||e.split===!1&&e.disableMainBtn===!0||e.disableDropdown===!0)&&(m["aria-disabled"]="true"),m}),w=B(()=>"q-btn-dropdown__arrow"+(r.value===!0&&e.noIconAnimation===!1?" rotate-180":"")+(e.split===!1?" q-btn-dropdown__arrow-container":"")),k=B(()=>tt(e)),s=B(()=>Tt(e));W(()=>e.modelValue,m=>{h.value?.[m?"show":"hide"]()}),W(()=>e.split,g);function L(m){r.value=!0,o("beforeShow",m)}function $(m){o("show",m),o("update:modelValue",!0)}function _(m){r.value=!1,o("beforeHide",m)}function N(m){o("hide",m),o("update:modelValue",!1)}function c(m){o("click",m)}function y(m){Ne(m),g(),o("click",m)}function u(m){h.value?.toggle(m)}function C(m){h.value?.show(m)}function g(m){h.value?.hide(m)}return Object.assign(l,{show:C,hide:g,toggle:u}),le(()=>{e.modelValue===!0&&C()}),()=>{const m=[v(ve,{class:w.value,name:e.dropdownIcon||l.$q.iconSet.arrow.dropdown})];return e.disableDropdown!==!0&&m.push(v(pt,{ref:h,id:a.value,class:e.contentClass,style:e.contentStyle,cover:e.cover,fit:!0,persistent:e.persistent,noEscDismiss:e.noEscDismiss,noRouteDismiss:e.noRouteDismiss,autoClose:e.autoClose,noFocus:e.noFocus,noRefocus:e.noRefocus,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,separateClosePopup:!0,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,onBeforeShow:L,onShow:$,onBeforeHide:_,onHide:N},t.default)),e.split===!1?v(I,{class:"q-btn-dropdown q-btn-dropdown--simple",...s.value,...f.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:c},{default:()=>J(t.label,[]).concat(m),loading:t.loading}):v(xt,{class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",rounded:e.rounded,square:e.square,...k.value,glossy:e.glossy,stretch:e.stretch},()=>[v(I,{class:"q-btn-dropdown--current",...s.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:y},{default:t.label,loading:t.loading}),v(I,{class:"q-btn-dropdown__arrow-container q-anchor--skip",...f.value,...k.value,disable:e.disable===!0||e.disableDropdown===!0,rounded:e.rounded,color:e.color,textColor:e.textColor,dense:e.dense,size:e.size,padding:e.padding,ripple:e.ripple},()=>m)])}}});function Ae(e,t,o){t.handler?t.handler(e,o,o.caret):o.runCmd(t.cmd,t.param)}function qe(e){return v("div",{class:"q-editor__toolbar-group"},e)}function Fe(e,t,o,l=!1){const r=l||(t.type==="toggle"?t.toggled?t.toggled(e):t.cmd&&e.caret.is(t.cmd,t.param):!1),h=[];if(e.$q.platform.is.desktop&&(t.tip||t.htmlTip)){const a=t.key?v("div",[v("small",`(CTRL + ${String.fromCharCode(t.key)})`)]):null;h.push(v(te,{delay:1e3},()=>[v("div",t.htmlTip?{innerHTML:t.htmlTip}:t.tip),a]))}return v(I,{...e.buttonProps.value,icon:t.icon!==null?t.icon:void 0,color:r?t.toggleColor||e.props.toolbarToggleColor:t.color||e.props.toolbarColor,textColor:r&&!e.props.toolbarPush?null:t.textColor||e.props.toolbarTextColor,label:t.label,"aria-label":t.label==null?t.tip:void 0,disable:t.disable?typeof t.disable=="function"?t.disable(e):!0:!1,size:"sm",onClick(a){o?.(),Ae(a,t,e)}},()=>h)}function $t(e,t){const o=t.list==="only-icons";let l=t.label,r=t.icon!==null?t.icon:void 0,h,a;function f(){k.component.proxy.hide()}if(o)a=t.options.map(s=>{const L=s.type===void 0?e.caret.is(s.cmd,s.param):!1;return L&&(l=s.tip,r=s.icon!==null?s.icon:void 0),Fe(e,s,f,L)}),h=e.toolbarBackgroundClass.value,a=[qe(a)];else{const s=e.props.toolbarToggleColor!==void 0?`text-${e.props.toolbarToggleColor}`:null,L=e.props.toolbarTextColor!==void 0?`text-${e.props.toolbarTextColor}`:null,$=t.list==="no-icons";a=t.options.map(_=>{const N=_.disable?_.disable(e):!1,c=_.type===void 0?e.caret.is(_.cmd,_.param):!1;c&&(l=_.tip,r=_.icon!==null?_.icon:void 0);const y=_.htmlTip;return v(ot,{active:c,activeClass:s,clickable:!0,disable:N,dense:!0,onClick(u){f(),u?.qAvoidFocus!==!0&&e.contentRef.value?.focus(),e.caret.restore(),Ae(u,_,e)}},()=>[$===!0?null:v(Be,{class:c?s:L,side:!0},()=>v(ve,{name:_.icon!==null?_.icon:void 0})),v(Be,y?()=>v("div",{class:"text-no-wrap",innerHTML:_.htmlTip}):_.tip?()=>v("div",{class:"text-no-wrap"},_.tip):void 0)])}),h=[e.toolbarBackgroundClass.value,L]}const w=t.highlight&&l!==t.label,k=v(Bt,{...e.buttonProps.value,noCaps:!0,noWrap:!0,color:w?e.props.toolbarToggleColor:e.props.toolbarColor,textColor:w&&!e.props.toolbarPush?null:e.props.toolbarTextColor,label:t.fixedLabel?t.label:l,icon:t.fixedIcon?t.icon!==null?t.icon:void 0:r,contentClass:h,onShow:s=>e.emit("dropdownShow",s),onHide:s=>e.emit("dropdownHide",s),onBeforeShow:s=>e.emit("dropdownBeforeShow",s),onBeforeHide:s=>e.emit("dropdownBeforeHide",s)},()=>a);return k}function Pt(e){if(e.caret)return e.buttons.value.filter(t=>!e.isViewingSource.value||t.find(o=>o.cmd==="viewsource")).map(t=>qe(t.map(o=>e.isViewingSource.value&&o.cmd!=="viewsource"?!1:o.type==="slot"?J(e.slots[o.slot]):o.type==="dropdown"?$t(e,o):Fe(e,o))))}function zt(e,t,o,l={}){const r=Object.keys(l);if(r.length===0)return{};const h={default_font:{cmd:"fontName",param:e,icon:o,tip:t}};return r.forEach(a=>{const f=l[a];h[a]={cmd:"fontName",param:f,icon:o,tip:f,htmlTip:`<font face="${f}">${f}</font>`}}),h}function Lt(e){if(e.caret){const t=e.props.toolbarColor||e.props.toolbarTextColor;let o=e.editLinkUrl.value;const l=()=>{e.caret.restore(),o!==e.editLinkUrl.value&&document.execCommand("createLink",!1,o===""?" ":o),e.editLinkUrl.value=null};return[v("div",{class:`q-mx-xs text-${t}`},`${e.$q.lang.editor.url}: `),v("input",{key:"qedt_btm_input",class:"col q-editor__link-input",value:o,onInput:r=>{Ne(r),o=r.target.value},onKeydown:r=>{if(De(r)!==!0)switch(r.keyCode){case 13:return Te(r),l();case 27:Te(r),e.caret.restore(),(!e.editLinkUrl.value||e.editLinkUrl.value==="https://")&&document.execCommand("unlink"),e.editLinkUrl.value=null;break}}}),qe([v(I,{key:"qedt_btm_rem",...e.buttonProps.value,label:e.$q.lang.label.remove,noCaps:!0,onClick:()=>{e.caret.restore(),document.execCommand("unlink"),e.editLinkUrl.value=null}}),v(I,{key:"qedt_btm_upd",...e.buttonProps.value,label:e.$q.lang.label.update,noCaps:!0,onClick:l})])]}}const It=Object.prototype.toString,ce=Object.prototype.hasOwnProperty,Nt=new Set(["Boolean","Number","String","Function","Array","Date","RegExp"].map(e=>"[object "+e+"]"));function Pe(e){if(e!==Object(e)||Nt.has(It.call(e))===!0||e.constructor&&ce.call(e,"constructor")===!1&&ce.call(e.constructor.prototype,"isPrototypeOf")===!1)return!1;let t;for(t in e);return t===void 0||ce.call(e,t)}function Re(){let e,t,o,l,r,h,a=arguments[0]||{},f=1,w=!1;const k=arguments.length;for(typeof a=="boolean"&&(w=a,a=arguments[1]||{},f=2),Object(a)!==a&&typeof a!="function"&&(a={}),k===f&&(a=this,f--);f<k;f++)if((e=arguments[f])!==null)for(t in e)o=a[t],l=e[t],a!==l&&(w===!0&&l&&((r=Array.isArray(l))||Pe(l)===!0)?(r===!0?h=Array.isArray(o)===!0?o:[]:h=Pe(o)===!0?o:{},a[t]=Re(w,h,l)):l!==void 0&&(a[t]=l));return a}const Dt=K({name:"QEditor",props:{...pe,...vt,modelValue:{type:String,required:!0},readonly:Boolean,disable:Boolean,minHeight:{type:String,default:"10rem"},maxHeight:String,height:String,definitions:Object,fonts:Object,placeholder:String,toolbar:{type:Array,validator:e=>e.length===0||e.every(t=>t.length),default:()=>[["left","center","right","justify"],["bold","italic","underline","strike"],["undo","redo"]]},toolbarColor:String,toolbarBg:String,toolbarTextColor:String,toolbarToggleColor:{type:String,default:"primary"},toolbarOutline:Boolean,toolbarPush:Boolean,toolbarRounded:Boolean,paragraphTag:{type:String,validator:e=>["div","p"].includes(e),default:"div"},contentStyle:Object,contentClass:[Object,Array,String],square:Boolean,flat:Boolean,dense:Boolean},emits:[...gt,"update:modelValue","keydown","click","focus","blur","dropdownShow","dropdownHide","dropdownBeforeShow","dropdownBeforeHide","linkShow","linkHide"],setup(e,{slots:t,emit:o}){const{proxy:l}=Z(),{$q:r}=l,h=ge(e,r),{inFullscreen:a,toggleFullscreen:f}=ht(),w=ct(),k=z(null),s=z(null),L=z(null),$=z(!1),_=B(()=>!e.readonly&&!e.disable);let N,c,y=e.modelValue;document.execCommand("defaultParagraphSeparator",!1,e.paragraphTag),N=window.getComputedStyle(document.body).fontFamily;const u=B(()=>e.toolbarBg?` bg-${e.toolbarBg}`:""),C=B(()=>({type:"a",flat:e.toolbarOutline!==!0&&e.toolbarPush!==!0,noWrap:!0,outline:e.toolbarOutline,push:e.toolbarPush,rounded:e.toolbarRounded,dense:!0,color:e.toolbarColor,disable:!_.value,size:"sm"})),g=B(()=>{const n=r.lang.editor,i=r.iconSet.editor;return{bold:{cmd:"bold",icon:i.bold,tip:n.bold,key:66},italic:{cmd:"italic",icon:i.italic,tip:n.italic,key:73},strike:{cmd:"strikeThrough",icon:i.strikethrough,tip:n.strikethrough,key:83},underline:{cmd:"underline",icon:i.underline,tip:n.underline,key:85},unordered:{cmd:"insertUnorderedList",icon:i.unorderedList,tip:n.unorderedList},ordered:{cmd:"insertOrderedList",icon:i.orderedList,tip:n.orderedList},subscript:{cmd:"subscript",icon:i.subscript,tip:n.subscript,htmlTip:"x<subscript>2</subscript>"},superscript:{cmd:"superscript",icon:i.superscript,tip:n.superscript,htmlTip:"x<superscript>2</superscript>"},link:{cmd:"link",disable:T=>T.caret&&!T.caret.can("link"),icon:i.hyperlink,tip:n.hyperlink,key:76},fullscreen:{cmd:"fullscreen",icon:i.toggleFullscreen,tip:n.toggleFullscreen,key:70},viewsource:{cmd:"viewsource",icon:i.viewSource,tip:n.viewSource},quote:{cmd:"formatBlock",param:"BLOCKQUOTE",icon:i.quote,tip:n.quote,key:81},left:{cmd:"justifyLeft",icon:i.left,tip:n.left},center:{cmd:"justifyCenter",icon:i.center,tip:n.center},right:{cmd:"justifyRight",icon:i.right,tip:n.right},justify:{cmd:"justifyFull",icon:i.justify,tip:n.justify},print:{type:"no-state",cmd:"print",icon:i.print,tip:n.print,key:80},outdent:{type:"no-state",disable:T=>T.caret&&!T.caret.can("outdent"),cmd:"outdent",icon:i.outdent,tip:n.outdent},indent:{type:"no-state",disable:T=>T.caret&&!T.caret.can("indent"),cmd:"indent",icon:i.indent,tip:n.indent},removeFormat:{type:"no-state",cmd:"removeFormat",icon:i.removeFormat,tip:n.removeFormat},hr:{type:"no-state",cmd:"insertHorizontalRule",icon:i.hr,tip:n.hr},undo:{type:"no-state",cmd:"undo",icon:i.undo,tip:n.undo,key:90},redo:{type:"no-state",cmd:"redo",icon:i.redo,tip:n.redo,key:89},h1:{cmd:"formatBlock",param:"H1",icon:i.heading1||i.heading,tip:n.heading1,htmlTip:`<h1 class="q-ma-none">${n.heading1}</h1>`},h2:{cmd:"formatBlock",param:"H2",icon:i.heading2||i.heading,tip:n.heading2,htmlTip:`<h2 class="q-ma-none">${n.heading2}</h2>`},h3:{cmd:"formatBlock",param:"H3",icon:i.heading3||i.heading,tip:n.heading3,htmlTip:`<h3 class="q-ma-none">${n.heading3}</h3>`},h4:{cmd:"formatBlock",param:"H4",icon:i.heading4||i.heading,tip:n.heading4,htmlTip:`<h4 class="q-ma-none">${n.heading4}</h4>`},h5:{cmd:"formatBlock",param:"H5",icon:i.heading5||i.heading,tip:n.heading5,htmlTip:`<h5 class="q-ma-none">${n.heading5}</h5>`},h6:{cmd:"formatBlock",param:"H6",icon:i.heading6||i.heading,tip:n.heading6,htmlTip:`<h6 class="q-ma-none">${n.heading6}</h6>`},p:{cmd:"formatBlock",param:e.paragraphTag,icon:i.heading,tip:n.paragraph},code:{cmd:"formatBlock",param:"PRE",icon:i.code,htmlTip:`<code>${n.code}</code>`},"size-1":{cmd:"fontSize",param:"1",icon:i.size1||i.size,tip:n.size1,htmlTip:`<font size="1">${n.size1}</font>`},"size-2":{cmd:"fontSize",param:"2",icon:i.size2||i.size,tip:n.size2,htmlTip:`<font size="2">${n.size2}</font>`},"size-3":{cmd:"fontSize",param:"3",icon:i.size3||i.size,tip:n.size3,htmlTip:`<font size="3">${n.size3}</font>`},"size-4":{cmd:"fontSize",param:"4",icon:i.size4||i.size,tip:n.size4,htmlTip:`<font size="4">${n.size4}</font>`},"size-5":{cmd:"fontSize",param:"5",icon:i.size5||i.size,tip:n.size5,htmlTip:`<font size="5">${n.size5}</font>`},"size-6":{cmd:"fontSize",param:"6",icon:i.size6||i.size,tip:n.size6,htmlTip:`<font size="6">${n.size6}</font>`},"size-7":{cmd:"fontSize",param:"7",icon:i.size7||i.size,tip:n.size7,htmlTip:`<font size="7">${n.size7}</font>`}}}),m=B(()=>{const n=e.definitions||{},i=e.definitions||e.fonts?Re(!0,{},g.value,n,zt(N,r.lang.editor.defaultFont,r.iconSet.editor.font,e.fonts)):g.value;return e.toolbar.map(T=>T.map(D=>{if(D.options)return{type:"dropdown",icon:D.icon,label:D.label,size:"sm",dense:!0,fixedLabel:D.fixedLabel,fixedIcon:D.fixedIcon,highlight:D.highlight,list:D.list,options:D.options.map(Ye=>i[Ye])};const M=i[D];return M?M.type==="no-state"||n[D]&&(M.cmd===void 0||g.value[M.cmd]&&g.value[M.cmd].type==="no-state")?M:Object.assign({type:"toggle"},M):{type:"slot",slot:D}}))}),q={$q:r,props:e,slots:t,emit:o,inFullscreen:a,toggleFullscreen:f,runCmd:ie,isViewingSource:$,editLinkUrl:L,toolbarBackgroundClass:u,buttonProps:C,contentRef:s,buttons:m,setContent:ne};W(()=>e.modelValue,n=>{y!==n&&(y=n,ne(n,!0))}),W(L,n=>{o(`link${n?"Show":"Hide"}`)});const V=B(()=>e.toolbar&&e.toolbar.length!==0),P=B(()=>{const n={},i=T=>{T.key&&(n[T.key]={cmd:T.cmd,param:T.param})};return m.value.forEach(T=>{T.forEach(D=>{D.options?D.options.forEach(i):i(D)})}),n}),b=B(()=>a.value?e.contentStyle:[{minHeight:e.minHeight,height:e.height,maxHeight:e.maxHeight},e.contentStyle]),x=B(()=>`q-editor q-editor--${$.value===!0?"source":"default"}`+(e.disable===!0?" disabled":"")+(a.value===!0?" fullscreen column":"")+(e.square===!0?" q-editor--square no-border-radius":"")+(e.flat===!0?" q-editor--flat":"")+(e.dense===!0?" q-editor--dense":"")+(h.value===!0?" q-editor--dark q-dark":"")),R=B(()=>[e.contentClass,"q-editor__content",{col:a.value,"overflow-auto":a.value||e.maxHeight}]),ae=B(()=>e.disable===!0?{"aria-disabled":"true"}:{});function j(){if(s.value!==null){const n=`inner${$.value===!0?"Text":"HTML"}`,i=s.value[n];i!==e.modelValue&&(y=i,o("update:modelValue",i))}}function Q(n){if(o("keydown",n),n.ctrlKey!==!0||De(n)===!0){F();return}const i=n.keyCode,T=P.value[i];if(T!==void 0){const{cmd:D,param:M}=T;at(n),ie(D,M,!1)}}function G(n){F(),o("click",n)}function Ue(n){if(s.value!==null){const{scrollTop:i,scrollHeight:T}=s.value;c=T-i}q.caret.save(),o("blur",n)}function We(n){nt(()=>{s.value!==null&&c!==void 0&&(s.value.scrollTop=s.value.scrollHeight-c)}),o("focus",n)}function Ke(n){const i=k.value;if(i!==null&&i.contains(n.target)===!0&&(n.relatedTarget===null||i.contains(n.relatedTarget)!==!0)){const T=`inner${$.value===!0?"Text":"HTML"}`;q.caret.restorePosition(s.value[T].length),F()}}function Ge(n){const i=k.value;i!==null&&i.contains(n.target)===!0&&(n.relatedTarget===null||i.contains(n.relatedTarget)!==!0)&&(q.caret.savePosition(),F())}function xe(){c=void 0}function je(n){q.caret.save()}function ne(n,i){if(s.value!==null){i===!0&&q.caret.savePosition();const T=`inner${$.value===!0?"Text":"HTML"}`;s.value[T]=n,i===!0&&(q.caret.restorePosition(s.value[T].length),F())}}function ie(n,i,T=!0){re(),q.caret.restore(),q.caret.apply(n,i,()=>{re(),q.caret.save(),T&&F()})}function F(){setTimeout(()=>{L.value=null,l.$forceUpdate()},1)}function re(){ft(()=>{s.value?.focus({preventScroll:!0})})}function Xe(){return s.value}return le(()=>{q.caret=l.caret=new qt(s.value,q),ne(e.modelValue),F(),document.addEventListener("selectionchange",je)}),lt(()=>{document.removeEventListener("selectionchange",je)}),Object.assign(l,{runCmd:ie,refreshToolbar:F,focus:re,getContentEl:Xe}),()=>{let n;if(V.value){const i=[v("div",{key:"qedt_top",class:"q-editor__toolbar row no-wrap scroll-x"+u.value},Pt(q))];L.value!==null&&i.push(v("div",{key:"qedt_btm",class:"q-editor__toolbar row no-wrap items-center scroll-x"+u.value},Lt(q))),n=v("div",{key:"toolbar_ctainer",class:"q-editor__toolbars-container"},i)}return v("div",{ref:k,class:x.value,style:{height:a.value===!0?"100%":null},...ae.value,onFocusin:Ke,onFocusout:Ge},[n,v("div",{ref:s,style:b.value,class:R.value,contenteditable:_.value,placeholder:e.placeholder,...w.listeners.value,onInput:j,onKeydown:Q,onClick:G,onBlur:Ue,onFocus:We,onMousedown:xe,onTouchstartPassive:xe})])}}}),Et={class:"text-h6 text-weight-bold"},Ot=["aria-busy"],Ht={class:"row q-col-gutter-md"},Vt={class:"col-12"},Qt={class:"col-6"},Mt={class:"col-6"},At={class:"row q-col-gutter-md"},Ft={class:"col-6"},Rt={class:"col-3"},Ut={class:"col-3"},Wt={class:"col-6"},Kt=he({__name:"ProjectEditor",props:{modelValue:{type:Boolean},mode:{},projectId:{},typeOptions:{}},emits:["update:modelValue","saved"],setup(e,{emit:t}){const o=e,l=t,r=we(),h=B({get:()=>o.modelValue,set:c=>l("update:modelValue",c)}),a=fe({id:0,title:"",location:"",description:"",project_type_id:null,scope:"",year:null,status:"",area:""}),f=z(!1),w=z(!1);function k(c){a.id=c.id??0,a.title=c.title??"",a.location=c.location??"",a.description=c.description??"",a.project_type_id=c.project_type_id??null,a.scope=c.scope??"",a.year=Number.isFinite(c.year)?c.year:null,a.status=c.status??"",a.area=c.area??""}async function s(){if(o.projectId){w.value=!0;try{const{data:c}=await E.get(`/projects/admin/${o.projectId}`);k(c)}catch(c){N(c,"Failed to load project")}finally{w.value=!1}}}function L(){k({})}function $(){h.value=!1}async function _(){if(!a.title?.trim()){r.notify({type:"warning",message:"Title is required"});return}if(!a.project_type_id){r.notify({type:"warning",message:"Project type is required"});return}f.value=!0;try{if(o.mode==="create"){const{data:c}=await E.post("/projects/admin",{title:a.title,location:a.location||null,description:a.description||"",project_type_id:a.project_type_id,scope:a.scope||null,year:a.year??null,status:a.status,area:a.area||null});l("saved",c.id)}else await E.patch(`/projects/admin/${o.projectId}`,{title:a.title,location:a.location||null,description:a.description||"",project_type_id:a.project_type_id,scope:a.scope||null,year:a.year??null,status:a.status,area:a.area||null}),l("saved",o.projectId);$(),r.notify({type:"positive",message:"Saved"})}catch(c){N(c,"Failed to save")}finally{f.value=!1}}function N(c,y="Error"){const u=c?.response?.data?.error||c?.message||y;r.notify({type:"negative",message:u})}return W(()=>o.modelValue,async c=>{c&&(o.mode==="edit"&&o.projectId?await s():L())}),(c,y)=>(O(),U(Se,{modelValue:h.value,"onUpdate:modelValue":y[8]||(y[8]=u=>h.value=u),persistent:""},{default:S(()=>[d(X,{style:{"min-width":"760px","max-width":"95vw"}},{default:S(()=>[d(Y,{class:"row items-center"},{default:S(()=>[p("div",Et,be(c.mode==="create"?"New Project":"Edit Project"),1),d(He),ye(d(I,{flat:"",round:"",dense:"",icon:"close"},null,512),[[_e]])]),_:1}),d(me),d(Y,{style:{"max-height":"70vh","overflow-y":"auto",position:"relative"}},{default:S(()=>[p("div",{class:"column q-gutter-lg","aria-busy":w.value},[p("div",null,[y[9]||(y[9]=p("div",{class:"text-subtitle2 text-grey-7 q-mb-sm"}," General Information ",-1)),p("div",Ht,[p("div",Vt,[d(A,{modelValue:a.title,"onUpdate:modelValue":y[0]||(y[0]=u=>a.title=u),label:"Title *",outlined:"",disable:f.value||w.value,rules:[u=>!!u&&u.trim().length>0||"Required"],autofocus:""},null,8,["modelValue","disable","rules"])]),p("div",Qt,[d(A,{modelValue:a.location,"onUpdate:modelValue":y[1]||(y[1]=u=>a.location=u),label:"Location",outlined:"",disable:f.value||w.value},null,8,["modelValue","disable"])]),p("div",Mt,[d(yt,{modelValue:a.project_type_id,"onUpdate:modelValue":y[2]||(y[2]=u=>a.project_type_id=u),options:c.typeOptions,"option-value":"id","option-label":"project_type","emit-value":"","map-options":"",outlined:"",clearable:"",label:"Project Type",disable:f.value||w.value},null,8,["modelValue","options","disable"])])])]),p("div",null,[y[10]||(y[10]=p("div",{class:"text-subtitle2 text-grey-7 q-mb-sm"}," Project Details ",-1)),p("div",At,[p("div",Ft,[d(A,{modelValue:a.scope,"onUpdate:modelValue":y[3]||(y[3]=u=>a.scope=u),label:"Scope",outlined:"",disable:f.value||w.value},null,8,["modelValue","disable"])]),p("div",Rt,[d(A,{modelValue:a.year,"onUpdate:modelValue":y[4]||(y[4]=u=>a.year=u),modelModifiers:{number:!0},type:"number",label:"Year",outlined:"",disable:f.value||w.value,min:"1900",max:"2100"},null,8,["modelValue","disable"])]),p("div",Ut,[d(A,{modelValue:a.status,"onUpdate:modelValue":y[5]||(y[5]=u=>a.status=u),label:"Status",outlined:"",disable:f.value||w.value},null,8,["modelValue","disable"])]),p("div",Wt,[d(A,{modelValue:a.area,"onUpdate:modelValue":y[6]||(y[6]=u=>a.area=u),label:"Area (e.g. 350 m²)",outlined:"",disable:f.value||w.value},null,8,["modelValue","disable"])])])]),p("div",null,[y[11]||(y[11]=p("div",{class:"text-subtitle2 text-grey-7 q-mb-sm"}," Description (HTML Content) ",-1)),d(Dt,{modelValue:a.description,"onUpdate:modelValue":y[7]||(y[7]=u=>a.description=u),"min-height":"200px",readonly:f.value||w.value,toolbar:[["bold","italic","strike","underline"],["quote","unordered","ordered","outdent","indent"],["link","hr"],["undo","redo"],["removeFormat"]]},null,8,["modelValue","readonly"])])],8,Ot),d(ke,{showing:w.value},{default:S(()=>[d(Ce,{size:"40px",color:"primary"})]),_:1},8,["showing"])]),_:1}),d(me),d(Ve,{align:"right"},{default:S(()=>[d(I,{flat:"",label:"Cancel",disable:f.value||w.value,onClick:$},null,8,["disable"]),d(I,{color:"primary",loading:f.value,disable:w.value,label:c.mode==="create"?"Create Project":"Save Changes",onClick:_},null,8,["loading","disable","label"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Gt=K({name:"QBar",props:{...pe,dense:Boolean},setup(e,{slots:t}){const{proxy:{$q:o}}=Z(),l=ge(e,o),r=B(()=>`q-bar row no-wrap items-center q-bar--${e.dense===!0?"dense":"standard"}  q-bar--${l.value===!0?"dark":"light"}`);return()=>v("div",{class:r.value,role:"toolbar"},J(t.default))}}),Xt={ratio:[String,Number]};function Yt(e,t){return B(()=>{const o=Number(e.ratio||(t!==void 0?t.value:void 0));return isNaN(o)!==!0&&o>0?{paddingBottom:`${100/o}%`}:null})}const Zt=1.7778,Jt=K({name:"QImg",props:{...Xt,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},loadingShowDelay:{type:[Number,String],default:0},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:Zt},placeholderSrc:String,errorSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:t,emit:o}){const l=z(e.initialRatio),r=Yt(e,l),h=Z(),{registerTimeout:a,removeTimeout:f}=$e(),{registerTimeout:w,removeTimeout:k}=$e(),s=B(()=>e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null),L=B(()=>e.errorSrc!==void 0?{src:e.errorSrc,__qerror:!0}:null),$=[z(null),z(s.value)],_=z(0),N=z(!1),c=z(!1),y=B(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),u=B(()=>({width:e.width,height:e.height})),C=B(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition q-img__image--`),g=B(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));function m(){if(k(),e.loadingShowDelay===0){N.value=!0;return}w(()=>{N.value=!0},e.loadingShowDelay)}function q(){k(),N.value=!1}function V({target:j}){se(h)===!1&&(f(),l.value=j.naturalHeight===0?.5:j.naturalWidth/j.naturalHeight,P(j,1))}function P(j,Q){Q===1e3||se(h)===!0||(j.complete===!0?b(j):a(()=>{P(j,Q+1)},50))}function b(j){se(h)!==!0&&(_.value=_.value^1,$[_.value].value=null,q(),j.getAttribute("__qerror")!=="true"&&(c.value=!1),o("load",j.currentSrc||j.src))}function x(j){f(),q(),c.value=!0,$[_.value].value=L.value,$[_.value^1].value=s.value,o("error",j)}function R(j){const Q=$[j].value,G={key:"img_"+j,class:C.value,style:g.value,alt:e.alt,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...Q};return _.value===j?Object.assign(G,{class:G.class+"current",onLoad:V,onError:x}):G.class+="loaded",v("div",{class:"q-img__container absolute-full",key:"img"+j},v("img",G))}function ae(){return N.value===!1?v("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},J(t[c.value===!0?"error":"default"])):v("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},t.loading!==void 0?t.loading():e.noSpinner===!0?void 0:[v(Le,{color:e.spinnerColor,size:e.spinnerSize})])}{let j=function(){W(()=>e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null,Q=>{f(),c.value=!1,Q===null?(q(),$[_.value^1].value=s.value):m(),$[_.value].value=Q},{immediate:!0})};it.value===!0?le(j):j()}return()=>{const j=[];return r.value!==null&&j.push(v("div",{key:"filler",style:r.value})),$[0].value!==null&&j.push(R(0)),$[1].value!==null&&j.push(R(1)),j.push(v(ze,{name:"q-transition--fade"},ae)),v("div",{key:"main",class:y.value,style:u.value,role:"img","aria-label":e.alt},j)}}}),eo={class:"text-subtitle1"},to={class:"row q-col-gutter-md items-center"},oo={class:"col-grow"},lo=["disabled"],ao={class:"col-auto"},no={class:"relative-position"},io={class:"row q-col-gutter-md"},ro={key:1,class:"bg-black"},so=["src","poster"],uo={class:"row q-gutter-sm"},co={key:0,class:"col-12"},fo=he({__name:"ProjectImagesManager",props:{modelValue:{type:Boolean},projectId:{},projectTitle:{}},emits:["update:modelValue","changed"],setup(e,{emit:t}){const o=e,l=t,r=we(),h=B({get:()=>o.modelValue,set:u=>l("update:modelValue",u)}),a=z([]),f=z(!1),w=z(!1),k=z(),s=B(()=>f.value||w.value);async function L(){if(o.projectId){f.value=!0;try{const{data:u}=await E.get(`/projects/admin/${o.projectId}`);u.media?.length?a.value=u.media.map(C=>({...C,__source:"media",alt:C.alt??""})):a.value=(u.images||[]).map(C=>({id:C.id,type:"image",file_url:C.file_url,thumb_url:C.thumb_url,sort_order:C.sort_order,alt:C.alt??"",__source:"image"}))}finally{f.value=!1}}}function $(){k.value?.click()}async function _(u){const C=Array.from(u.target.files||[]);if(!(!o.projectId||!C.length)){w.value=!0;try{const g=C.filter(q=>q.type.startsWith("image/")),m=C.filter(q=>q.type==="video/mp4");if(g.length){const q=new FormData;g.forEach(V=>q.append("files",V)),await E.post(`/projects/admin/${o.projectId}/media`,q)}for(const q of m){if(q.size>20*1024*1024){r.notify({type:"warning",message:`Video ${q.name} exceeds 20MB`});continue}await y(q)}await L(),l("changed")}catch(g){console.error(g),r.notify({type:"negative",message:"Upload failed"})}finally{w.value=!1,k.value&&(k.value.value="")}}}async function N(u){const C=u.__source==="media"?`/projects/admin/${o.projectId}/media/${u.id}`:`/projects/admin/${o.projectId}/images/${u.id}`;await E.patch(C,{alt:u.alt?.trim()||null,sort_order:u.sort_order||0}),r.notify({type:"positive",message:"Saved"}),await L()}async function c(u){const C=u.__source==="media"?`/projects/admin/${o.projectId}/media/${u.id}`:`/projects/admin/${o.projectId}/images/${u.id}`;await E.delete(C),r.notify({type:"positive",message:"Deleted"}),await L()}async function y(u){if(!o.projectId)return;const{data:C}=await E.post(`/projects/admin/${o.projectId}/media/video-upload-url`,{filename:u.name,mimeType:u.type}),{uploadUrl:g,path:m}=C;await fetch(g,{method:"PUT",headers:{"Content-Type":u.type},body:u}),await E.post(`/projects/admin/${o.projectId}/media/video-confirm`,{path:m,mimeType:u.type})}return W(()=>o.modelValue,u=>u&&L()),(u,C)=>(O(),U(Se,{modelValue:h.value,"onUpdate:modelValue":C[0]||(C[0]=g=>h.value=g),persistent:"",maximized:""},{default:S(()=>[d(X,null,{default:S(()=>[d(Gt,{class:"bg-grey-2"},{default:S(()=>[p("div",eo," Media — Project "+be(u.projectTitle??"—"),1),d(He),ye(d(I,{flat:"",dense:"",icon:"close",disable:w.value},null,8,["disable"]),[[_e]])]),_:1}),w.value?(O(),U(Ee,{key:0,indeterminate:"",color:"primary",class:"q-mb-none"})):oe("",!0),d(Y,{class:"q-pt-md"},{default:S(()=>[p("div",to,[p("div",oo,[p("input",{ref_key:"fileInput",ref:k,type:"file",multiple:"",accept:"image/*,video/mp4",class:"hidden",disabled:s.value,onChange:_},null,40,lo),d(I,{color:"primary",icon:"upload",label:"Select media",unelevated:"",disable:s.value,onClick:$},null,8,["disable"]),C[1]||(C[1]=p("div",{class:"text-caption text-grey-7 q-mt-xs"},[p("div",null,[H("Max "),p("b",null,"3"),H(" files per upload")]),p("div",{class:"q-mt-xs"},[p("b",null,"Images:"),H(" auto-resized, max 20 MB"),p("br"),p("b",null,"Videos:"),H(" MP4, max 20 MB ")])],-1))]),p("div",ao,[d(I,{outline:"",icon:"refresh",label:"Refresh",loading:f.value,disable:w.value,onClick:L},null,8,["loading","disable"])])]),d(me,{class:"q-my-md"}),p("div",no,[p("div",io,[(O(!0),ee(st,null,rt(a.value,g=>(O(),ee("div",{key:`${g.__source}-${g.id}`,class:"col-12 col-sm-6 col-md-4 col-lg-3"},[d(X,{bordered:""},{default:S(()=>[g.type==="image"?(O(),U(Jt,{key:0,src:g.file_url,ratio:4/3},null,8,["src"])):(O(),ee("div",ro,[p("video",{src:g.file_url,poster:g.thumb_url||void 0,controls:"",muted:"",preload:"metadata",style:{width:"100%"}},null,8,so)])),d(Y,{class:"q-gutter-sm"},{default:S(()=>[d(A,{modelValue:g.alt,"onUpdate:modelValue":m=>g.alt=m,dense:"",outlined:"",label:"Alt text",disable:s.value},null,8,["modelValue","onUpdate:modelValue","disable"]),d(A,{modelValue:g.sort_order,"onUpdate:modelValue":m=>g.sort_order=m,modelModifiers:{number:!0},dense:"",outlined:"",type:"number",label:"Sort order",disable:s.value},null,8,["modelValue","onUpdate:modelValue","disable"]),p("div",uo,[d(I,{dense:"",color:"primary",icon:"save",label:"Save",disable:s.value,onClick:m=>N(g)},null,8,["disable","onClick"]),d(I,{dense:"",color:"negative",flat:"",icon:"delete",label:"Delete",disable:s.value,onClick:m=>c(g)},null,8,["disable","onClick"])])]),_:2},1024)]),_:2},1024)]))),128)),!f.value&&a.value.length===0?(O(),ee("div",co,[d(_t,{dense:"",class:"bg-grey-2"},{default:S(()=>[...C[2]||(C[2]=[H(" No media yet. Upload images or videos. ",-1)])]),_:1})])):oe("",!0)]),d(ke,{showing:f.value},{default:S(()=>[d(Ce,{size:"40px"})]),_:1},8,["showing"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),mo={class:"row items-center justify-between q-mb-md"},po={class:"row items-center q-gutter-sm"},go={class:"row items-center justify-center column",style:{"min-height":"220px"}},qo=he({__name:"ProjectsPage",setup(e){const t=we(),o=z(""),l=z(!0),r=z([]),h=[{name:"id",label:"ID",field:"id",align:"left",sortable:!0,style:"width: 70px"},{name:"title",label:"Title",field:"title",align:"left",sortable:!0},{name:"project_type",label:"Type",field:"project_type_id",align:"left"},{name:"year",label:"Year",field:"year",align:"left",sortable:!0,style:"width: 90px"},{name:"status",label:"Status",field:"status",align:"left",style:"width: 120px"},{name:"actions",label:"",field:"actions",align:"right",style:"width: 140px"}],a=z([]);function f(P){const b=a.value.find(x=>x.id===P);return b?b.project_type:"—"}async function w(){try{const{data:P}=await E.get("/project-types");a.value=P}catch(P){V(P,"Failed to load project types")}}async function k(P=!1){P||(l.value=!0);try{const b={};o.value&&(b.q=o.value);const{data:x}=await E.get("/projects/admin",{params:b});r.value=x}catch(b){V(b,"Failed to load projects")}finally{P||(l.value=!1)}}const s=fe({open:!1,mode:"create",id:null});function L(){s.open=!0,s.mode="create",s.id=null}function $(P){s.open=!0,s.mode="edit",s.id=P}async function _(){await k()}const N=z(!1),c=z(null),y=z(null);function u(P,b){c.value=P,y.value=b,N.value=!0}async function C(){await k()}const g=fe({open:!1,id:null,loading:!1});function m(P){g.open=!0,g.id=P}async function q(){g.loading=!0;try{await E.delete(`/projects/admin/${g.id}`),t.notify({type:"positive",message:"Deleted"}),g.open=!1,await k()}catch(P){V(P,"Failed to delete")}finally{g.loading=!1}}function V(P,b="Error"){const x=P?.response?.data?.error||P?.message||b;t.notify({type:"negative",message:x})}return le(async()=>{try{await w(),await k(!0)}finally{l.value=!1}}),(P,b)=>(O(),U(St,{padding:"",class:"column q-gutter-lg","aria-busy":l.value},{default:S(()=>[b[11]||(b[11]=p("div",{class:"q-pa-sm q-mt-xs bg-yellow-2 text-yellow-9 rounded-borders text-body2"},[H(" ⚠️ Updates may take a few minutes to appear on "),p("strong",null,"hsarchitect.id"),H(" after saving. ")],-1)),p("div",mo,[b[5]||(b[5]=p("div",{class:"column"},[p("div",{class:"text-h5 text-weight-bold"},"Projects"),p("div",{class:"text-caption text-grey-7"}," Manage all architectural projects in your CMS ")],-1)),p("div",po,[d(A,{modelValue:o.value,"onUpdate:modelValue":[b[1]||(b[1]=x=>o.value=x),k],dense:"",outlined:"",debounce:"300",placeholder:"Search title",style:{width:"260px"},disable:l.value},{prepend:S(()=>[d(ve,{name:"search"})]),append:S(()=>[o.value?(O(),U(I,{key:0,flat:"",dense:"",round:"",icon:"close",onClick:b[0]||(b[0]=x=>{o.value="",k()}),disable:l.value},null,8,["disable"])):oe("",!0)]),_:1},8,["modelValue","disable"]),d(I,{color:"primary",icon:"add",label:"New Project",unelevated:"",onClick:L,disable:l.value},null,8,["disable"])])]),l.value?(O(),U(Ee,{key:0,indeterminate:"",color:"primary",class:"q-mb-md"})):oe("",!0),d(X,{flat:"",bordered:"",class:"q-pa-none relative-position"},{default:S(()=>[d(ke,{showing:l.value},{default:S(()=>[p("div",go,[d(Ce,{size:"48px",color:"primary"}),b[6]||(b[6]=p("div",{class:"text-subtitle2 q-mt-md"},"Loading projects…",-1))])]),_:1},8,["showing"]),d(bt,{rows:r.value,columns:h,"row-key":"id",loading:l.value,pagination:{rowsPerPage:0},flat:"",separator:"horizontal","no-data-label":"No projects yet","no-results-label":"No matches found"},{"body-cell-project_type":S(x=>[d(ue,{props:x},{default:S(()=>[d(wt,{square:"",dense:"",color:"grey-3","text-color":"grey-9",class:"text-uppercase"},{default:S(()=>[H(be(f(x.row.project_type_id)),1)]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-status":S(x=>[d(ue,{props:x},{default:S(()=>[d(ut,{label:x.row.status,color:"blue-5",class:"q-px-sm q-py-xs text-uppercase"},null,8,["label"])]),_:2},1032,["props"])]),"body-cell-actions":S(x=>[d(ue,{props:x,class:"q-gutter-xs text-right"},{default:S(()=>[d(I,{dense:"",flat:"",round:"",icon:"image",color:"primary",onClick:R=>u(x.row.id,x.row.title),disable:l.value},{default:S(()=>[d(te,null,{default:S(()=>[...b[7]||(b[7]=[H("Manage Images",-1)])]),_:1})]),_:1},8,["onClick","disable"]),d(I,{dense:"",flat:"",round:"",icon:"edit",color:"secondary",onClick:R=>$(x.row.id),disable:l.value},{default:S(()=>[d(te,null,{default:S(()=>[...b[8]||(b[8]=[H("Edit Project",-1)])]),_:1})]),_:1},8,["onClick","disable"]),d(I,{dense:"",flat:"",round:"",icon:"delete",color:"negative",onClick:R=>m(x.row.id),disable:l.value},{default:S(()=>[d(te,null,{default:S(()=>[...b[9]||(b[9]=[H("Delete Project",-1)])]),_:1})]),_:1},8,["onClick","disable"])]),_:2},1032,["props"])]),_:1},8,["rows","loading"])]),_:1}),d(Kt,{modelValue:s.open,"onUpdate:modelValue":b[2]||(b[2]=x=>s.open=x),mode:s.mode,"project-id":s.id,"type-options":a.value,onSaved:_},null,8,["modelValue","mode","project-id","type-options"]),d(fo,{modelValue:N.value,"onUpdate:modelValue":b[3]||(b[3]=x=>N.value=x),"project-id":c.value,"project-title":y.value,onChanged:C},null,8,["modelValue","project-id","project-title"]),d(Se,{modelValue:g.open,"onUpdate:modelValue":b[4]||(b[4]=x=>g.open=x)},{default:S(()=>[d(X,null,{default:S(()=>[d(Y,null,{default:S(()=>[...b[10]||(b[10]=[p("div",{class:"text-h6"},"Delete this project?",-1),p("div",{class:"text-body2 text-grey-7 q-mt-xs"}," This will also remove all associated images. ",-1)])]),_:1}),d(Ve,{align:"right"},{default:S(()=>[ye(d(I,{flat:"",label:"Cancel",color:"grey-7",disable:g.loading},null,8,["disable"]),[[_e]]),d(I,{color:"negative",label:"Delete",loading:g.loading,onClick:q},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["aria-busy"]))}});export{qo as default};
